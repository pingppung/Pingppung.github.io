### **`개발 환경`**
- spring boot 3.2.2
- react 18.2.0
- Node.js 18.x
- docker 27.1.1
- mysql 8.0.36
- Gradle

### **`프로젝트 구조`**

```
├─📂.gradle
├─📂.idea
├─📂backend
│  ├─📂build
│  ├─📂src
│  │   ├─📂main
│  │   └─📂test
│  ├─📜Dockerfile
│  └─📜build.gradle
├─📂frontend
│  ├─📂node_module
│  ├─📂public
│  ├─📂src
│  ├─📜Dockerfile
│  └─📜package.json
├─📂bin
├─📂gradle
├─📂wrapper
├─📜docer-compose.yml
└─📜.env
```

- `./gradlew build clean` → jar 파일 만들기(war 수정 가능)
- `docker pull mysql:버전`
- `Dockerfile` 작성

```
//backend

FROM openjdk:17-jdk-alpine

WORKDIR /src

CMD ["./gradlew", "clean", "build"]

COPY build/libs/backend-0.0.1-SNAPSHOT.jar app.jar

EXPOSE 8080

ENTRYPOINT ["java","-jar","./app.jar"]

```

```
//frontend
 
FROM node:18-alpine

WORKDIR /src

COPY package.json .

RUN npm install

COPY . .

EXPOSE 3000

CMD [ "npm", "start" ]
```

- `docker-compose.yml` 작성

```
services:
  db:
    image: mysql:8.0.36
    volumes:
      - ./db_data:/var/lib/mysql
    ports:
      - "3307:3306"
    environment:
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      MYSQL_DATABASE: ${MYSQL_DATABASE}
      MYSQL_USER: ${MYSQL_USER}
      MYSQL_PASSWROD: ${MYSQL_PASSWORD}
    healthcheck:
      test: [ "CMD", "mysqladmin" ,"ping", "-h", "contenthub-db-1" ]
      interval: 3s
      timeout: 20s
      retries: 10
    networks:
      - network

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: contenthub-frontend
    ports:
      - "3000:3000"
    networks:
      - network

  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: contenthub-backend
    ports:
      - "8080:8080"
    depends_on:
      - db
    environment:
      SPRING_DATASOURCE_URL: ${SPRING_DATASOURCE_URL}
      SPRING_DATASOURCE_USERNAME: ${SPRING_DATASOURCE_USERNAME}
      SPRING_DATASOURCE_PASSWORD: ${SPRING_DATASOURCE_PASSWORD}
    networks:
      - network

networks:
  network:
    driver: bridge
```

- `package.json`  수정
    
    로컬에서 실행할 때는 프록시를 [**http://localhost:8080**](http://localhost:8080) 으로 하는게 맞는데 도커에 올리면 [**http://backend:8080**](http://backend:8080) 으로 수정 → `docker-compose.yml`에서 썼던 서비스 이름으로 작성해줘야함
    (컨테이너 이름x)
    

- `docker-compose up --build` 명령어를 사용하면, `docker-compose.yml` 파일에 정의된 서비스에 맞게 **이미지를 생성**한 후, **컨테이너를 실행**
